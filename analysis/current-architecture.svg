<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; }
      .component { font-family: Arial, sans-serif; font-size: 12px; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; }
      .problem-text { font-family: Arial, sans-serif; font-size: 11px; fill: #8B0000; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title">Current Monolithic Java Audit System</text>
  
  <!-- Main container -->
  <rect x="50" y="60" width="700" height="450" rx="10" fill="#FF6B35" fill-opacity="0.3" stroke="black" stroke-width="2"/>
  <text x="400" y="85" text-anchor="middle" class="subtitle">Java Audit System</text>
  
  <!-- MITM Proxy Layer -->
  <rect x="80" y="110" width="640" height="120" rx="5" fill="#F7931E" fill-opacity="0.7" stroke="black"/>
  <text x="400" y="135" text-anchor="middle" class="subtitle">MITM Proxy Layer</text>
  
  <!-- MITM Components -->
  <rect x="100" y="150" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="170" y="175" text-anchor="middle" class="component">MonitorSSHAudit.java</text>
  <text x="170" y="190" text-anchor="middle" class="small-text">SSH MITM + Credential</text>
  <text x="170" y="205" text-anchor="middle" class="small-text">Injection</text>
  
  <rect x="260" y="150" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="330" y="175" text-anchor="middle" class="component">MonitorVNCAudit.java</text>
  <text x="330" y="190" text-anchor="middle" class="small-text">VNC MITM + Credential</text>
  <text x="330" y="205" text-anchor="middle" class="small-text">Injection</text>
  
  <rect x="420" y="150" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="490" y="175" text-anchor="middle" class="component">Rdp2ProxyHandler.java</text>
  <text x="490" y="190" text-anchor="middle" class="small-text">RDP MITM + Credential</text>
  <text x="490" y="205" text-anchor="middle" class="small-text">Injection</text>
  
  <rect x="580" y="150" width="120" height="60" rx="3" fill="white" stroke="black"/>
  <text x="640" y="175" text-anchor="middle" class="component">SessionInfo.java</text>
  <text x="640" y="190" text-anchor="middle" class="small-text">Credential Handler</text>
  <text x="640" y="205" text-anchor="middle" class="small-text">Integration</text>
  
  <!-- Audit Logging Layer -->
  <rect x="80" y="250" width="640" height="120" rx="5" fill="#4ECDC4" fill-opacity="0.7" stroke="black"/>
  <text x="400" y="275" text-anchor="middle" class="subtitle">Audit Logging Layer</text>
  
  <!-- Audit Components -->
  <rect x="100" y="290" width="120" height="60" rx="3" fill="white" stroke="black"/>
  <text x="160" y="315" text-anchor="middle" class="component">AuditFile.java</text>
  <text x="160" y="330" text-anchor="middle" class="small-text">Binary audit file</text>
  <text x="160" y="345" text-anchor="middle" class="small-text">generation</text>
  
  <rect x="240" y="290" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="310" y="315" text-anchor="middle" class="component">DatabaseAuditWriter.java</text>
  <text x="310" y="330" text-anchor="middle" class="small-text">Database persistence</text>
  
  <rect x="400" y="290" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="470" y="315" text-anchor="middle" class="component">TerminalAuditWriter.java</text>
  <text x="470" y="330" text-anchor="middle" class="small-text">Terminal audit files</text>
  
  <rect x="560" y="290" width="140" height="60" rx="3" fill="white" stroke="black"/>
  <text x="630" y="315" text-anchor="middle" class="component">GuessingConnectionLinker</text>
  <text x="630" y="330" text-anchor="middle" class="small-text">Session linking</text>
  
  <!-- Credential Injection Service -->
  <rect x="80" y="390" width="640" height="80" rx="5" fill="#45B7D1" fill-opacity="0.7" stroke="black"/>
  <text x="400" y="415" text-anchor="middle" class="subtitle">Credential Injection Service</text>
  <text x="400" y="435" text-anchor="middle" class="component">CredentialInjectionService.java (Parent Integration)</text>
  
  <!-- Tight coupling arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="red"/>
    </marker>
  </defs>
  
  <!-- MITM to Audit arrows -->
  <line x1="400" y1="230" x2="400" y2="250" stroke="red" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- MITM to Credential arrows -->
  <line x1="400" y1="230" x2="400" y2="390" stroke="red" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Audit to Credential arrows -->
  <line x1="400" y1="370" x2="400" y2="390" stroke="red" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Tight coupling indicator -->
  <rect x="420" y="300" width="80" height="40" rx="5" fill="red" fill-opacity="0.3" stroke="red"/>
  <text x="460" y="315" text-anchor="middle" class="small-text" fill="red">Tight</text>
  <text x="460" y="330" text-anchor="middle" class="small-text" fill="red">Coupling</text>
  
  <!-- Client connection -->
  <rect x="10" y="170" width="60" height="40" rx="5" fill="lightblue" stroke="black"/>
  <text x="40" y="185" text-anchor="middle" class="small-text">Client</text>
  <text x="40" y="200" text-anchor="middle" class="small-text">Connections</text>
  
  <!-- Client arrow -->
  <defs>
    <marker id="bluearrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="blue"/>
    </marker>
  </defs>
  <line x1="70" y1="190" x2="100" y2="190" stroke="blue" stroke-width="2" marker-end="url(#bluearrow)"/>
  
  <!-- Problems annotation -->
  <rect x="50" y="530" width="700" height="60" rx="5" fill="yellow" fill-opacity="0.7" stroke="black"/>
  <text x="60" y="550" class="problem-text">Problems with Current Architecture:</text>
  <text x="60" y="565" class="problem-text">• Tight coupling between MITM and audit • Single point of failure • Difficult to add web client support</text>
  <text x="60" y="580" class="problem-text">• Complex threading model • Data loss risk from coupling • 3-5 minute rebuild cycles</text>
</svg>
